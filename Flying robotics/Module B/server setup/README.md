
# Методичка по настройке и работе с сервером Clever Show

## 1. Настройка конфигурации сервера

### 1.1 Открытие конфигурационного файла
1. В верхней панели интерфейса сервера нажмите **Server**
2. Выберите **Edit Server Config**

### 1.2 Редактирование параметров конфигурации
В открывшемся окне измените следующие значения:

```ini
[CHECKS]
check_current_position = False    # Было True
start_pos_delta_max = 0           # Максимальное отклонение стартовой позиции
```
<img width="597" height="728" alt="image" src="https://github.com/user-attachments/assets/b927b55d-ba49-45cf-a477-a94ac8b7be37" />

**Объяснение параметров:**
- `check_current_position = False` - отключает проверку текущей позиции при старте
- `start_pos_delta_max = 0` - устанавливает нулевое максимальное отклонение стартовой позиции

### 1.3 Сохранение изменений
После редактирования сохраните файл и перезагрузите сервер.

## 2. Добавление анимации для дрона

### 2.1 Выбор дрона
1. В интерфейсе сервера найдите нужный дрон в списке
2. Установите **галочку** напротив выбранного дрона

### 2.2 Загрузка анимации
1. Нажмите **Selected drones**
2. Выберите вкладку **Send**
3. Нажмите **Animation**
4. Выберите нужный CSV-файл с анимацией
   
<img width="388" height="277" alt="image" src="https://github.com/user-attachments/assets/f80ecfdb-b83f-413e-8e3a-f7af7af609e7" />

### 2.3 Применение изменений
После загрузки анимации выполните **Restart Service** (chorny, clever-show, clever) для применения изменений.

## 3. Получение координат дрона

### 3.1 Подготовка к определению позиции
Для того чтобы дрон определил своё местоположение:

1. **Включите kill_switch** (если активирован)
2. **Занесите дрон в полётную зону**
3. **Поднимите дрон на высоту 1.5-2 метра**

### 3.2 Проверка координат
После подъёма в интерфейсе сервера в разделе дрона должны появиться актуальные координаты:
- `current_x` - координата по оси X
- `current_y` - координата по оси Y  
- `current_z` - координата по оси Z (высота)
- `current_yaw` - угол рысканья
- `frame_id` - идентификатор системы координат

Вместо `NO_POS` должны отображаться числовые значения.

## 4. Решение распространённых проблем

### 4.1 Проблема: Отрицательная координата по оси Z
**Симптомы:** В поле `current_z` значение меньше 0

**Решение:**
1. Выполните **REBOOT FCU** (перезагрузку полётного контроллера)
2. Если не помогло, выполните калибровку:
   - **Gyro Calibration** (калибровка гироскопа)
   - **Level Calibration** (калибровка горизонта)

### 4.2 Проблема: Аномальное значение dt
**Симптомы:** Параметр `dt` подсвечивается красным цветом

**Решение:**
1. Откройте **Настройки Windows**
2. Перейдите в **Время и язык**
3. Выберите **Дата и время**
4. Включите **Установить время автоматически**
5. Нажмите **Синхронизировать сейчас**

### 4.3 Проблема: Долго не появляются координаты
**Решение:**
1. Убедитесь, что дрон находится в зоне действия системы позиционирования
2. Проверьте освещённость (некоторые системы требуют хорошего освещения)
3. Убедитесь, что маркеры/камеры системы позиционирования видят дрон

## 5. Последовательность запуска

### Рекомендуемый порядок действий:
1. ✅ Настройка конфигурации сервера
2. ✅ Подготовка анимации (если требуется)
3. ✅ Внесение дрона в полётную зону
4. ✅ Подъём на высоту 1.5-2 метра
5. ✅ Проверка получения координат
6. ✅ Устранение проблем (если необходимо)
7. ✅ Запуск анимации/полёта

## 6. Быстрые команды через интерфейс

```
Server → Edit Server Config → [изменить параметры] → Save
[выбрать дрон] → Selected drones → Send → Animation → [выбрать файл] → Restart Service
[внести в зону] → [поднять на 1.5-2м] → [проверить координаты]
```

## 7. Важные замечания

### Безопасность:
- Перед внесением дрона в полётную зону всегда проверяйте активацию kill_switch
- Не подходите к дрону во время полёта
- Следите за уровнем заряда батареи

### Производительность:
- Для стабильной работы рекомендуется закрыть лишние приложения
- Убедитесь в стабильном Wi-Fi соединении
- При работе с несколькими дронами увеличьте `buffer_size` в конфигурации

### Отладка:
- Все изменения конфигурации требуют перезапуска сервиса
- При проблемах проверяйте логи сервера
- Сохраняйте рабочие конфигурации как бэкапы
