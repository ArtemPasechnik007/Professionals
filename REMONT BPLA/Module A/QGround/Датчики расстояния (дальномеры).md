# Датчики расстояния (дальномеры)
Датчики расстояния обеспечивают измерение расстояния, которое можно использовать для следования рельефу местности, удержания над рельефом местности (например, для точного зависания при съемке), 
улучшения поведения при посадке (условная дальность действия), предупреждения о предельных значениях высоты, предотвращения столкновений и т. д.

В этом разделе перечислены датчики расстояния, поддерживаемые PX4 (со ссылками на более подробную документацию), общая конфигурация, необходимая для всех дальномеров, тестирование и моделирование. 
Более подробная информация о настройке и конфигурации приведена в разделах, ссылки на которые приведены ниже (и на боковой панели).

<img width="529" height="354" alt="image" src="https://github.com/user-attachments/assets/7832866c-bb06-46a1-aa43-387bffc83f1b" />


# Конфигурация/настройка
Дальномеры обычно подключаются к последовательному порту (ШИМ) или порту I2C (в зависимости от драйвера устройства) и активируются на порту путем установки определенного параметра.

# Общая конфигурация
Общая конфигурация дальномера задается с помощью параметров EKF2_RNG_*. К ним относятся (неполный список):

EKF2_RNG_POS_X, EKF2_RNG_POS_Y, EKF2_RNG_POS_Z — смещение дальномера от центра тяжести транспортного средства по осям X, Y, Z.
EKF2_RNG_PITCH — значение 0 градусов (по умолчанию) соответствует тому, что дальномер точно совмещён с вертикальной осью транспортного средства (то есть направлен прямо вниз), а значение 90 градусов указывает на то, что дальномер направлен вперёд. Для вычисления расстояния до земли при ненулевом угле тангажа используется простая тригонометрия.
EKF2_RNG_DELAY — приблизительная задержка передачи данных от датчика к системе оценки.
EKF2_RNG_SFE — масштабирование шума дальномера в зависимости от расстояния.
EKF2_RNG_NOISE — шум измерений для слияния данных дальномера
Тестирование
Самый простой способ проверить дальномер — изменить расстояние и сравнить значения, полученные с помощью PX4. В разделах ниже описаны некоторые способы измерения расстояния.

# QGroundControl MAVLink Inspector
QGroundControl MAVLink Inspector позволяет просматривать сообщения, отправляемые с дрона, в том числе DISTANCE_SENSOR информацию с дальномера. 
Основное различие между этими инструментами заключается в том, что инструмент Analyze может отображать значения в виде графика.

::: примечание Отправляемые сообщения зависят от конфигурации транспортного средства. Вы будете получать DISTANCE_SENSOR сообщений только в том случае, если на подключенном транспортном средстве установлен дальномер и он передает данные с датчиков. :::

Чтобы просмотреть результаты дальномера:

1. Откройте меню Q> Выберите Инструмент > Инструменты анализа:
Меню для инструмента QGC Analyze


<img width="195" height="241" alt="image" src="https://github.com/user-attachments/assets/15f312d9-bd4e-40b5-b4e6-c4ab2409f7f4" />


2. Выберите сообщение DISTANCE_SENSOR, а затем установите флажок "Построить график" против current_distance. Затем инструмент отобразит результат:QGC анализирует значение DISTANCE_SENSOR


<img width="1847" height="902" alt="image" src="https://github.com/user-attachments/assets/7349f9fc-6558-4755-9bc1-5b63c737c9bb" />


# Консоль QGroundControl MAVLink
Вы также можете использовать Консоль QGroundControl MAVLink для просмотра темы distance_sensor uORB:
listener distance_sensor 5

::: примечание Консоль QGroundControl MAVLink работает при подключении к Pixhawk или другим устройствам NuttX, но не к симулятору. В симуляторе вы можете запускать команды непосредственно в терминале.
